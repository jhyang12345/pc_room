from pymongo import MongoClient
from CafeProfile import CafeProfile
from util import *

port_number = 27018

name = "Pica_test"

grid_corners = """
0.12877440478596547 0.13448275862068965
0.7716459840737298 0.9103448275862069
"""

grid_cell_locations = """
0.15006289450721302 0.16376531270148292
0.15006289450721302 0.23404255319148937
0.15006289450721302 0.30625402965828497
0.15006289450721302 0.3778207607994842
0.15006289450721302 0.4513217279174726
0.15006289450721302 0.521598968407479
0.15006289450721302 0.5950999355254675
0.15006289450721302 0.6647324306898775
0.15006289450721302 0.7343649258542876
0.20880976394728193 0.6634429400386848
0.20880976394728193 0.7343649258542876
0.20880976394728193 0.8020631850419084
0.20880976394728193 0.8755641521598968
0.26683136339426355 0.16698903932946485
0.26683136339426355 0.23984526112185686
0.26683136339426355 0.30754352030947774
0.26683136339426355 0.3797549967762734
0.26683136339426355 0.4513217279174726
0.26683136339426355 0.5235332043842682
0.26683136339426355 0.5957446808510638
0.26683136339426355 0.6647324306898775
0.37199551239191775 0.6634429400386848
0.37199551239191775 0.7330754352030948
0.37199551239191775 0.804642166344294
0.37199551239191775 0.8768536428110896
0.3168749929172852 0.16634429400386846
0.3168749929172852 0.23726627981947132
0.3168749929172852 0.30883301096067056
0.3168749929172852 0.38168923275306255
0.3168749929172852 0.4513217279174726
0.3168749929172852 0.521598968407479
0.3168749929172852 0.5957446808510638
0.3168749929172852 0.6653771760154739
0.4216765069183958 0.662153449387492
0.4216765069183958 0.7324306898774984
0.4216765069183958 0.804642166344294
0.4216765069183958 0.8768536428110896
0.4844123613204447 0.1650548033526757
0.4844123613204447 0.2366215344938749
0.4844123613204447 0.3107672469374597
0.4844123613204447 0.3803997421018698
0.4844123613204447 0.4526112185686654
0.4844123613204447 0.521598968407479
0.4844123613204447 0.597678916827853
0.4844123613204447 0.6673114119922631
0.4844123613204447 0.7382333978078659
0.5906644153077298 0.6602192134107028
0.5906644153077298 0.7311411992263056
0.5906644153077298 0.8020631850419084
0.5906644153077298 0.8749194068343005
0.5351812608365536 0.2366215344938749
0.5351812608365536 0.3114119922630561
0.5351812608365536 0.3803997421018698
0.5351812608365536 0.4506769825918762
0.5351812608365536 0.5241779497098646
0.5351812608365536 0.5950999355254675
0.5351812608365536 0.6647324306898775
0.5351812608365536 0.7375886524822695
0.6465102047754496 0.16892327530625403
0.6465102047754496 0.24049000644745325
0.6465102047754496 0.3114119922630561
0.6465102047754496 0.3829787234042553
0.6465102047754496 0.4551901998710509
0.6465102047754496 0.5254674403610574
0.6465102047754496 0.5963894261766602
0.6465102047754496 0.6679561573178594
0.7270151740081366 0.2192134107027724
0.7270151740081366 0.2907801418439716
0.7270151740081366 0.3617021276595745
0.7270151740081366 0.4345583494519665
0.7270151740081366 0.5061250805931657
0.7074328841947803 0.6653771760154739
0.7074328841947803 0.7362991618310767
0.7074328841947803 0.807865892972276
0.7074328841947803 0.8787878787878788

"""

base_grid = """
|....|.....
|.||.||.|.|
|.||.||.|.|
|.||.||.|.|
|.||.||.|.|
|.||.||.|.|
|.||.||.|..
|.||.||.|..
|.||.||.|..
...........
|.||.|....|
|.||.|....|
|.||.|....|
|.||.|.##.|
"""

anchor_image = "images\hough\snap_180119_142836_hough.png"

column_sort = True

# Save the color of Taken Seats!!!
color = (76, 55, 117)

def handle_coords(value):
    text = value.strip()
    coords = text.split("\n")
    def split(coords):
        return list(map(float, coords.split()))
    coords = list(map(split, coords))
    # half(coords)
    # if column_sort:
    #     coords = sorted(coords, key = lambda x: (x[0], x[1]))
    # else:
    #     coords = sorted(coords, key = lambda x: (x[1], x[0]))
    return coords

def main():
    global name, grid_corners, grid_cell_locations, anchor_image, base_grid, color

    grid_corners = handle_coords(grid_corners)
    grid_cell_locations = handle_coords(grid_cell_locations)

    c = CafeProfile(name, grid_corners, grid_cell_locations,
    anchor_image, base_grid, color=color)
    c.save_profile()

if __name__ == '__main__':
    main()
